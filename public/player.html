<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hohohoot</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0a;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #fff;
        }

        .container {
            max-width: 480px;
            width: 100%;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .home-link {
            display: inline-block;
            color: #6b7280;
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
            transition: color 0.2s;
        }

        .home-link:hover {
            color: #a855f7;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
        }

        .header h1 span {
            background: linear-gradient(135deg, #6366f1, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Cards */
        .card {
            background: #18181b;
            border: 1px solid #27272a;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #fff;
            text-align: center;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            font-size: 0.95rem;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: #fff;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #a1a1aa;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            font-size: 1.25rem;
            font-family: inherit;
            background: #27272a;
            border: 1px solid #3f3f46;
            border-radius: 10px;
            color: #fff;
            transition: all 0.2s;
            text-align: center;
            letter-spacing: 0.1em;
        }

        .form-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-input::placeholder {
            color: #52525b;
            letter-spacing: normal;
        }

        /* Player Info */
        .player-info {
            text-align: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1));
            border-radius: 16px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            margin-bottom: 1.5rem;
        }

        .player-nickname {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .player-pin {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
        }

        /* Status Message */
        .status-message {
            text-align: center;
            padding: 2rem;
            color: #a1a1aa;
            font-size: 1.1rem;
        }

        .status-message .emoji {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }

        .status-message .answer-count {
            margin-top: 1rem;
            font-size: 1rem;
            font-weight: 600;
            color: #a855f7;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.1);
            border-radius: 20px;
            display: inline-block;
        }

        /* Answer Buttons */
        .answers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .answer-btn {
            aspect-ratio: 1;
            border: none;
            border-radius: 16px;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            position: relative;
            overflow: hidden;
        }

        .answer-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0);
            transition: background 0.2s;
        }

        .answer-btn:hover:not(:disabled)::before {
            background: rgba(255, 255, 255, 0.1);
        }

        .answer-btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        .answer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .answer-btn.red {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .answer-btn.blue {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        .answer-btn.yellow {
            background: linear-gradient(135deg, #eab308, #ca8a04);
        }

        .answer-btn.green {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        /* Answer button symbols */
        .answer-btn .symbol {
            font-size: 7rem;
            font-weight: bold;
            opacity: 0.7;
        }

        .answer-btn.red .symbol {
            color: #b91c1c;
        }

        .answer-btn.blue .symbol {
            color: #1d4ed8;
        }

        .answer-btn.yellow .symbol {
            color: #a16207;
        }

        .answer-btn.green .symbol {
            color: #15803d;
        }

        .answer-btn .symbol-x {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .answer-btn .symbol-x svg {
            width: 7rem;
            height: 7rem;
        }

        .answer-btn.selected {
            animation: pulse 0.3s ease;
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.5);
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(0.92);
            }
        }

        /* Timer */
        .timer-display {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .timer-number {
            font-size: 4rem;
            font-weight: 800;
            color: #fff;
            line-height: 1;
        }

        .timer-number.warning {
            color: #eab308;
        }

        .timer-number.danger {
            color: #ef4444;
            animation: pulse-danger 0.5s ease-in-out infinite;
        }

        @keyframes pulse-danger {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .timer-bar {
            height: 6px;
            background: #27272a;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .timer-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #22c55e, #eab308, #ef4444);
            border-radius: 3px;
            transition: width 0.1s linear;
        }

        /* Question Info */
        .question-info {
            text-align: center;
            font-size: 1rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        /* Result Display */
        .result-display {
            text-align: center;
            padding: 2rem;
        }

        .result-emoji {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .result-text {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .result-text.correct {
            color: #22c55e;
        }

        .result-text.incorrect {
            color: #ef4444;
        }

        .result-text.timeout {
            color: #eab308;
        }

        .result-score {
            font-size: 1rem;
            color: #6b7280;
        }

        .result-score span {
            color: #a855f7;
            font-weight: 600;
        }

        .result-rank {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 1rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            border-radius: 1rem;
            color: #fff;
        }

        /* Leaderboard */
        .leaderboard-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 1.5rem;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: #27272a;
            border-radius: 12px;
            margin-bottom: 0.75rem;
        }

        .leaderboard-rank {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 700;
            border-radius: 10px;
            background: #3f3f46;
            color: #fff;
        }

        .leaderboard-item:nth-child(1) .leaderboard-rank {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
        }

        .leaderboard-item:nth-child(2) .leaderboard-rank {
            background: linear-gradient(135deg, #94a3b8, #64748b);
        }

        .leaderboard-item:nth-child(3) .leaderboard-rank {
            background: linear-gradient(135deg, #f97316, #ea580c);
        }

        .leaderboard-name {
            flex: 1;
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
        }

        .leaderboard-name.you {
            color: #a855f7;
        }

        .leaderboard-score {
            font-size: 1.25rem;
            font-weight: 700;
            color: #a855f7;
        }

        /* Error */
        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            text-align: center;
            margin-top: 0.5rem;
        }

        /* Utility */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-2 {
            margin-bottom: 1rem;
        }

        .mt-2 {
            margin-top: 1rem;
        }

        /* Responsive */
        @media (max-width: 400px) {
            .answer-btn {
                font-size: 1.5rem;
            }

            .timer-number {
                font-size: 3rem;
            }
        }

        /* Countdown Overlay */
        .countdown-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 10, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            pointer-events: all;
        }

        .countdown-number {
            font-size: 12rem;
            font-weight: 800;
            background: linear-gradient(135deg, #6366f1, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: countdownFadeIn 0.5s ease-out;
        }

        @keyframes countdownFadeIn {
            0% {
                opacity: 0;
                transform: scale(0.5);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .question-screen-fade {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <!-- Countdown Overlay -->
    <div id="countdown-overlay" class="countdown-overlay hidden">
        <div id="countdown-number" class="countdown-number">3</div>
    </div>

    <div class="container">
        <div class="header">
            <a href="/" class="home-link">‚Üê Back to Menu</a>
            <h1>üéØ <span>Hohohoot</span></h1>
        </div>

        <!-- Join Screen -->
        <div id="join-screen" class="card">
            <div class="card-title">Join a Game</div>
            <div class="form-group">
                <label class="form-label">Game PIN</label>
                <input type="text" id="pin-input" class="form-input" placeholder="Enter 6-digit PIN" maxlength="6"
                    inputmode="numeric" pattern="[0-9]*">
            </div>
            <div class="form-group">
                <label class="form-label">Your Nickname</label>
                <input type="text" id="nickname-input" class="form-input" placeholder="Enter your name" maxlength="20">
            </div>
            <button id="join-btn" class="btn btn-primary" disabled>Join Game</button>
            <div id="error-message" class="error-message hidden"></div>
        </div>

        <!-- Waiting Screen -->
        <div id="waiting-screen" class="card hidden">
            <div class="player-info">
                <div class="player-nickname" id="display-nickname">Player</div>
                <div class="player-pin">Game PIN: <span id="display-pin">------</span></div>
            </div>
            <div class="status-message">
                <span class="emoji">‚è≥</span>
                Waiting for host to start the game...
            </div>
        </div>

        <!-- Question Screen -->
        <div id="question-screen" class="card hidden">
            <div class="question-info" id="question-info">Question 1 of 5</div>
            <div class="timer-display">
                <div class="timer-number" id="timer-number">20</div>
                <div class="timer-bar">
                    <div class="timer-bar-fill" id="timer-bar" style="width: 100%;"></div>
                </div>
            </div>
            <div class="answers-grid">
                <button class="answer-btn red" data-answer="0"><span class="symbol">‚ñ†</span></button>
                <button class="answer-btn blue" data-answer="1"><span class="symbol">‚ñ≤</span></button>
                <button class="answer-btn yellow" data-answer="2"><span class="symbol">‚óè</span></button>
                <button class="answer-btn green" data-answer="3"><span class="symbol symbol-x"><svg
                            viewBox="0 0 100 100" fill="none" stroke="#15803d" stroke-width="24" stroke-linecap="round">
                            <line x1="20" y1="20" x2="80" y2="80" />
                            <line x1="80" y1="20" x2="20" y2="80" />
                        </svg></span></button>
            </div>
        </div>

        <!-- Answer Submitted Screen -->
        <div id="submitted-screen" class="card hidden">
            <div class="status-message">
                <span class="emoji">‚úÖ</span>
                Answer submitted!<br>
                <div class="answer-count" id="player-answer-count">Waiting for others...</div>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="card hidden">
            <div class="result-display">
                <div class="result-emoji" id="result-emoji">‚úÖ</div>
                <div class="result-text" id="result-text">Correct!</div>
                <div class="result-score">Your score: <span id="result-score">0</span></div>
                <div class="result-rank" id="result-rank"></div>
            </div>
        </div>

        <!-- Final Screen -->
        <div id="final-screen" class="card hidden">
            <div class="leaderboard-title">üéâ Game Over!</div>
            <div id="final-leaderboard"></div>
            <button id="play-again-btn" class="btn btn-primary mt-2">Play Again</button>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Ensure Socket.IO is loaded
        if (typeof io === 'undefined') {
            document.body.innerHTML = '<div style="text-align: center; margin-top: 50px; color: #fff;"><h1>Error</h1><p>Failed to load Socket.IO library. Please refresh the page.</p></div>';
            throw new Error('Socket.IO not loaded');
        }

        const socket = io();

        socket.on('connect_error', function (err) {
            document.body.innerHTML = '<div style="text-align: center; margin-top: 50px; color: #fff;"><h1>Connection Error</h1><p>Failed to connect to the server. Please check your internet connection and try again.</p></div>';
        });

        let currentPin = null;
        let currentNickname = null;
        let currentScore = 0;
        let playerTimerInterval = null;
        let playerAnswerTimeLimit = 20;
        let hasAnswered = false;

        // Elements
        const joinScreen = document.getElementById('join-screen');
        const waitingScreen = document.getElementById('waiting-screen');
        const questionScreen = document.getElementById('question-screen');
        const submittedScreen = document.getElementById('submitted-screen');
        const resultScreen = document.getElementById('result-screen');
        const finalScreen = document.getElementById('final-screen');

        const pinInput = document.getElementById('pin-input');
        const nicknameInput = document.getElementById('nickname-input');
        const joinBtn = document.getElementById('join-btn');
        const errorMessage = document.getElementById('error-message');

        const displayNickname = document.getElementById('display-nickname');
        const displayPin = document.getElementById('display-pin');

        const questionInfo = document.getElementById('question-info');
        const timerNumber = document.getElementById('timer-number');
        const timerBar = document.getElementById('timer-bar');
        const answerBtns = document.querySelectorAll('.answer-btn');

        const resultEmoji = document.getElementById('result-emoji');
        const resultText = document.getElementById('result-text');
        const resultScore = document.getElementById('result-score');
        const resultRank = document.getElementById('result-rank');

        const finalLeaderboard = document.getElementById('final-leaderboard');
        const playAgainBtn = document.getElementById('play-again-btn');

        // Input validation
        function validateInputs() {
            const pin = pinInput.value.trim();
            const nickname = nicknameInput.value.trim();
            joinBtn.disabled = !(pin.length === 6 && /^\d{6}$/.test(pin) && nickname.length >= 1);
        }

        pinInput.addEventListener('input', validateInputs);
        nicknameInput.addEventListener('input', validateInputs);

        // Join game
        joinBtn.addEventListener('click', () => {
            const pin = pinInput.value.trim();
            const nickname = nicknameInput.value.trim();

            currentPin = pin;
            currentNickname = nickname;

            socket.emit('player-join', { pin, nickname });
        });

        // Enter key support
        pinInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') nicknameInput.focus();
        });

        nicknameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !joinBtn.disabled) joinBtn.click();
        });

        // Join success
        socket.on('join-success', (data) => {
            displayNickname.textContent = currentNickname;
            displayPin.textContent = currentPin;
            showScreen('waiting');
        });

        // Countdown overlay elements
        const countdownOverlay = document.getElementById('countdown-overlay');
        const countdownNumberEl = document.getElementById('countdown-number');
        let isCountdownActive = false;

        // Block inputs during countdown
        function blockInputsDuringCountdown(e) {
            if (isCountdownActive) {
                e.preventDefault();
                e.stopPropagation();
                return false;
            }
        }

        document.addEventListener('keydown', blockInputsDuringCountdown, true);
        document.addEventListener('click', blockInputsDuringCountdown, true);

        function showCountdownThenQuestion(callback) {
            isCountdownActive = true;
            let count = 3;
            countdownNumberEl.textContent = count;
            countdownNumberEl.style.animation = 'none';
            countdownOverlay.classList.remove('hidden');
            // Force reflow to restart animation
            void countdownNumberEl.offsetWidth;
            countdownNumberEl.style.animation = 'countdownFadeIn 0.5s ease-out';

            const countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownNumberEl.textContent = count;
                    countdownNumberEl.style.animation = 'none';
                    void countdownNumberEl.offsetWidth;
                    countdownNumberEl.style.animation = 'countdownFadeIn 0.5s ease-out';
                } else {
                    clearInterval(countdownInterval);
                    countdownOverlay.classList.add('hidden');
                    isCountdownActive = false;
                    callback();
                }
            }, 1000);
        }

        // Error handling
        socket.on('error', (data) => {
            errorMessage.textContent = data.message;
            errorMessage.classList.remove('hidden');
        });

        // Show question
        socket.on('show-question', (data) => {
            hasAnswered = false;
            questionInfo.textContent = `Question ${data.questionNumber} of ${data.totalQuestions}`;

            playerAnswerTimeLimit = data.answerTimeLimit || 20;

            // Disable buttons during countdown
            answerBtns.forEach(btn => {
                btn.disabled = true;
                btn.classList.remove('selected');
            });

            // Show countdown first, then question
            showCountdownThenQuestion(() => {
                // Enable buttons and start timer AFTER countdown
                answerBtns.forEach(btn => {
                    btn.disabled = false;
                });
                startPlayerTimer(playerAnswerTimeLimit);

                // Add fade-in effect
                questionScreen.classList.add('question-screen-fade');
                showScreen('question');
                setTimeout(() => questionScreen.classList.remove('question-screen-fade'), 300);
            });
        });

        function startPlayerTimer(duration) {
            if (playerTimerInterval) clearInterval(playerTimerInterval);

            let timeLeft = duration;
            timerNumber.textContent = timeLeft;
            timerNumber.className = 'timer-number';
            timerBar.style.width = '100%';

            playerTimerInterval = setInterval(() => {
                timeLeft--;
                timerNumber.textContent = timeLeft;

                const percentage = (timeLeft / duration) * 100;
                timerBar.style.width = percentage + '%';

                if (timeLeft <= 5) {
                    timerNumber.className = 'timer-number danger';
                } else if (timeLeft <= 10) {
                    timerNumber.className = 'timer-number warning';
                }

                if (timeLeft <= 0) {
                    clearInterval(playerTimerInterval);
                    if (!hasAnswered) {
                        answerBtns.forEach(btn => btn.disabled = true);
                    }
                }
            }, 1000);
        }

        // Answer buttons
        answerBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                if (hasAnswered) return;

                hasAnswered = true;
                const answer = parseInt(btn.dataset.answer);

                btn.classList.add('selected');
                answerBtns.forEach(b => b.disabled = true);

                if (playerTimerInterval) clearInterval(playerTimerInterval);

                socket.emit('player-answer', {
                    pin: currentPin,
                    answerIndex: answer
                });

                showScreen('submitted');
            });
        });

        // Answer recorded
        socket.on('answer-recorded', (data) => {
            // Already showing submitted screen
        });

        // Answer count update (only shown after player has answered)
        socket.on('answer-count-update', (data) => {
            const playerAnswerCountEl = document.getElementById('player-answer-count');
            if (playerAnswerCountEl) {
                playerAnswerCountEl.textContent = `${data.answered} / ${data.total} answered`;
            }
        });

        // Answer revealed (when timer expires or all players answered)
        // Player stays on submitted screen, waits for host to show results
        socket.on('answer-revealed', (data) => {
            // Just update the score internally, don't change screen
            const myResult = data.playerResults ? data.playerResults[socket.id] : null;
            if (myResult) {
                currentScore = myResult.totalScore;
            }
        });

        // Question results (when host shows leaderboard)
        socket.on('question-results', (data) => {
            const myResult = data.playerResults ? data.playerResults[socket.id] : null;

            if (myResult) {
                currentScore = myResult.totalScore;

                if (myResult.correct) {
                    resultEmoji.textContent = '‚úÖ';
                    resultText.textContent = 'Correct!';
                    resultText.className = 'result-text correct';
                } else if (myResult.answered) {
                    resultEmoji.textContent = '‚ùå';
                    resultText.textContent = 'Incorrect';
                    resultText.className = 'result-text incorrect';
                } else {
                    resultEmoji.textContent = '‚è∞';
                    resultText.textContent = 'Time\'s up!';
                    resultText.className = 'result-text timeout';
                }

                resultScore.textContent = currentScore;
            }

            // Find player's rank in leaderboard
            if (data.leaderboard) {
                const myRank = data.leaderboard.findIndex(p => p.nickname === currentNickname) + 1;
                if (myRank > 0) {
                    const totalPlayers = data.leaderboard.length;
                    resultRank.textContent = `#${myRank} of ${totalPlayers}`;
                } else {
                    resultRank.textContent = '';
                }
            }

            showScreen('result');
        });

        // Game ended
        socket.on('game-ended', (data) => {
            if (playerTimerInterval) clearInterval(playerTimerInterval);

            finalLeaderboard.innerHTML = data.leaderboard.map((player, index) => {
                const isMe = player.odentity === socket.id || player.nickname === currentNickname;
                return `<div class="leaderboard-item">
                    <div class="leaderboard-rank">${index + 1}</div>
                    <div class="leaderboard-name ${isMe ? 'you' : ''}">${player.nickname}${isMe ? ' (You)' : ''}</div>
                    <div class="leaderboard-score">${player.score}</div>
                </div>`;
            }).join('');

            showScreen('final');
        });

        // Host disconnected
        socket.on('host-disconnected', () => {
            alert('Host disconnected. Game ended.');
            location.reload();
        });

        // Play again
        playAgainBtn.addEventListener('click', () => {
            location.reload();
        });

        function showScreen(screen) {
            joinScreen.classList.add('hidden');
            waitingScreen.classList.add('hidden');
            questionScreen.classList.add('hidden');
            submittedScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            finalScreen.classList.add('hidden');

            switch (screen) {
                case 'join':
                    joinScreen.classList.remove('hidden');
                    break;
                case 'waiting':
                    waitingScreen.classList.remove('hidden');
                    break;
                case 'question':
                    questionScreen.classList.remove('hidden');
                    break;
                case 'submitted':
                    submittedScreen.classList.remove('hidden');
                    break;
                case 'result':
                    resultScreen.classList.remove('hidden');
                    break;
                case 'final':
                    finalScreen.classList.remove('hidden');
                    break;
            }
        }
    </script>
</body>

</html>